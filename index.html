<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Lecteur vidéo local — Sans compte</title>
<style>
  :root{
    --bg:#0b0f13;
    --card:#0f1720;
    --muted:#9aa6b2;
    --accent:#ef4444; /* rouge upload */
    --white:#ffffff;
    --radius:12px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
    background:linear-gradient(180deg,var(--bg),#071014 120%);
    color:var(--white);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    padding:24px;
  }

  /* Layout */
  .app{max-width:1100px;margin:0 auto;display:grid;grid-template-columns:1fr 340px;gap:20px;align-items:start}
  header{display:flex;align-items:center;gap:12px;margin-bottom:8px}
  /* Removed .logo */
  h1{margin:0;font-size:1.25rem}
  .subtitle{color:var(--muted);font-size:0.9rem;margin-top:6px}

  /* Main column cards */
  .card{background:linear-gradient(180deg,var(--card),#071018);border-radius:var(--radius);padding:16px;box-shadow:0 8px 30px rgba(2,6,23,.6);border:1px solid rgba(255,255,255,0.03)}
  .controls{display:flex;gap:8px;align-items:center;justify-content:space-between;margin-bottom:12px}
  .tabs{display:flex;gap:8px}
  .tab{padding:8px 12px;border-radius:999px;background:transparent;border:1px solid rgba(255,255,255,0.04);cursor:pointer;color:var(--muted);font-size:0.9rem}
  .tab.active{background:rgba(255,255,255,0.04);color:var(--white);border-color:rgba(255,255,255,0.06)}

  /* video list */
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
  .video-card{background:linear-gradient(180deg,#071018,#0b1116);padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);display:flex;flex-direction:column;gap:8px}
  .thumb{background:#000;border-radius:8px;height:130px;display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}
  .thumb video{width:100%;height:100%;object-fit:cover;filter:brightness(.9)}
  .meta{font-size:0.9rem}
  .meta h3{margin:0;font-size:0.95rem}
  .meta p{margin:4px 0 0;color:var(--muted);font-size:0.85rem;height:2.2em;overflow:hidden}
  .row{display:flex;gap:8px;align-items:center;justify-content:space-between}
  .btn{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:6px 10px;border-radius:8px;color:var(--muted);cursor:pointer;font-size:0.85rem}
  .icon-btn{display:inline-flex;align-items:center;justify-content:center;width:36px;height:36px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.03);cursor:pointer}

  /* right column */
  aside .card{position:sticky;top:24px}
  .small{font-size:0.85rem;color:var(--muted)}

  /* Floating upload button - removed icon */
  .upload-fab{
    position:fixed;right:22px;bottom:22px;width:64px;height:64px;border-radius:50%;
    background:var(--accent);display:flex;align-items:center;justify-content:center;color:var(--white);
    box-shadow:0 12px 30px rgba(239,68,68,0.25);cursor:pointer;border:4px solid rgba(255,255,255,0.03);z-index:9999;
    font-weight:700;
    font-size:1.5rem;
  }
  .upload-fab:hover{transform:translateY(-3px);transition:transform .14s ease}

  /* modal */
  .modal-back{position:fixed;inset:0;background:rgba(2,6,23,0.6);display:flex;align-items:center;justify-content:center;z-index:10000}
  .modal{width:min(720px,96%);border-radius:12px;padding:18px;background:linear-gradient(180deg,#071018,#0b1116);border:1px solid rgba(255,255,255,0.03)}
  label{display:block;margin-bottom:6px;font-size:0.85rem;color:var(--muted)}
  input[type="text"], textarea{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--white);outline:none;font-size:0.95rem}
  textarea{resize:vertical;min-height:90px}
  .form-row{display:flex;gap:8px}
  .muted{color:var(--muted);font-size:0.85rem}

  /* video player overlay */
  .player-overlay{position:fixed;inset:0;background:rgba(2,6,23,0.85);display:flex;align-items:center;justify-content:center;z-index:10001;padding:20px}
  .player-box{width:min(1100px,98%);max-height:86vh;border-radius:12px;background:#071018;padding:12px}
  .player-meta{display:flex;align-items:center;justify-content:space-between;gap:8px;margin-top:8px}

  /* responsive */
  @media (max-width:980px){
    .app{grid-template-columns:1fr; padding-bottom:90px}
    aside{order:2}
  }
</style>
</head>
<body>
  <header>
    <h1>Soan</h1>
    <div class="subtitle">Uploader et regarder des vidéos sans compte — stockage local (IndexedDB)</div>
  </header>

  <div class="app">
    <main>
      <section class="card">
        <div class="controls">
          <div class="tabs" role="tablist" aria-label="Sections">
            <button class="tab active" data-tab="most">Les plus vues</button>
            <button class="tab" data-tab="fav">Favoris</button>
          </div>
          <div style="display:flex;gap:8px;align-items:center">
            <div class="small" id="count-videos">0 vidéos</div>
            <button class="btn" id="clear-all">Vider tout</button>
          </div>
        </div>

        <div id="content">
          <div class="grid" id="videos-grid"></div>
        </div>
      </section>
    </main>

    <aside>
      <div class="card">
        <h3>Infos</h3>
        <p class="small">Upload via le bouton rouge en bas à droite. Aucune connexion demandée. Les vidéos restent sur cet appareil/navigateur.</p>
        <hr style="opacity:.06;margin:12px 0">
        <div>
          <div class="small">Témoignage technique</div>
          <p class="muted">La base utilise IndexedDB pour stocker blobs vidéo et métadonnées. Attends quelques secondes après upload pour traitement.</p>
        </div>
        <hr style="opacity:.06;margin:12px 0">
        <div class="small">Raccourcis</div>
        <p class="muted">Cliquer sur une miniature ouvre le lecteur et incrémente les vues.</p>
      </div>
    </aside>
  </div>

  <!-- Floating upload button with no icon, just text "+" -->
  <div class="upload-fab" id="fab" title="Uploader une vidéo" aria-label="Uploader une vidéo">+</div>

  <!-- hidden file input -->
  <input type="file" id="file-input" accept="video/*" style="display:none" />

  <!-- Upload modal -->
  <div id="modal-root" style="display:none"></div>

  <!-- player overlay -->
  <div id="player-root" style="
